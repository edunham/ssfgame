<head>

</head>

<body>
    <style>
        .wrapper {
            display: flex;
            flex-direction: row;
        }

        .wrapper>div {
            font-size: 4vh;
            color: white;
            background: lightslategrey;
            margin: .1em;
            padding: .3em;
            border-radius: 3px;
            flex: 1;
            flex-direction: row;
        }

        .wrapper .wrapper>div {
            background: lightgray;
            color: blue;
            flex-direction: row;

        }

        .tooltip {
            display: none;
        }
    </style>
    <div class="wrapper">

        <div id="clock">day 0</div>
    </div>
    <div class="wrapper">
        <div>Tools
            <div id="current-tool">no tool selected</div>
            <div class="wrapper" id="tools">
                <div><button id='research'>Research</button></div>
                <div><button id='phish'>Phish</button></div>
                <div>3</div>
            </div>
        </div>
        <div>Places
            <div class="wrapper" id="places">
            </div>
        </div>
    </div>

    <div id="clock"></div>
    <!-- -->
    <script>
        var cash = 0;
        starters = [5, 10, 15, 20, 25, 30, 35, 40]
        faces = ["👦", "👧", "👨", "👩", "👴", "👵", "😀", "😁", "😂", "😃", "😄", "😅", "😆", "😎", "😇", "😏", "😐", "😉", "😊", "😑", "😒", "😋", "😌", "😓", "😔", "😍", "😕", "😜", "😝", "😖", "😗",
            "😞", "😟", "😘", "😙", "😠", "😡", "😚", "😛", "😢", "😪", "😣", "😤", "😫", "😥", "😬", "😦", "😭", "😧", "😮", "😯", "😩", "😨", "😲", "😳", "😴", "😵", "😶", "😷", "🙁", "🙂", "🙃", "🙄", "🤐",
            "🤑", "🤒", "🤓", "🤔", "🤤", "🤕", "🤥", "🤗", "🤠", "🤡", "🤧", "🤣", "🥸", "🤩", "😵‍💫", "🤫", "🤭", "🧐", "🤨", "😮‍💨", "😶‍🌫️"];

        places = ["🏦", "🏨", "🏫", "🏠", "🏛️", "🏬", "🏭", "🏥", "🏣", "🏗️", "🏢", "🏘️"];


        function pickone(items) {
            //get a random one of several things
            return items[Math.floor(Math.random() * items.length)];
        }

        function Person() {
            this.face = pickone(faces);
            this.times = [pickone(places), pickone(places), pickone(places), pickone(places)];
            this.caution = 0.5;
            this.salary = 10;
            this.wallet = pickone(starters);
        }
        function move(who, to) {
            const whence = document.getElementById(who['face']);
            whence.remove();
            var where = document.getElementById(to);
            where.appendChild(whence);
            /*
            const elementToMove = document.querySelector(who);
            const newParentElement = document.querySelector(to);
            newParentElement.appendChild(elementToMove);*/

        }
        var times = ['🌅', '🏙️', '🌇', '🌃'];

        var days = 0
        var now = 0
        people = []

        for (let step = 0; step < 15; step++) {
            people.push(new Person())
        }
        for (p in places) {
            var parent = document.getElementById("places");
            var child = document.createElement("div");
            child.id = places[p];
            child.textContent = places[p];
            parent.appendChild(child);
        }

        for (p in people) {
            var parent = document.getElementById(people[p]['times'][0]);
            var child = document.createElement("div");
            child.id = people[p]['face'];
            child.textContent = people[p]['face'];
            parent.appendChild(child)
        };

        // phishing tool
        document.getElementById('phish').addEventListener('click', function () {
            console.log("you clicked the phisher");
            document.getElementById("current-tool")
                .innerHTML = "Phishing...";

            for (p in people) {
                document.getElementById(people[p]['face']).addEventListener('click', function () {
                    //tried to phish them
                    console.log("you tried to phish " + people[p]['face']);
                    if (Math.random() > people[p]['caution']) {
                        //successfully phished
                        console.log("phishing successful!");
                        if (people[p]['wallet'] > 10) {
                            console.log("money acquired");
                            people[p]['wallet'] -= 10;
                            cash += 10;
                        }
                    }
                })
            }
        })

        function showTooltip() {
            const tooltip = document.querySelector(".tooltip");
            tooltip.style.display = "block";
        }
        function hideTooltip() {
            const tooltip = document.querySelector(".tooltip");
            tooltip.style.display = "none";
        }


        //researching tool
        document.getElementById('research').addEventListener('click', function () {
            console.log("you clicked the researcher");
            document.getElementById("current-tool")
                .innerHTML = "Researching...";

            for (p in people) {
                document.getElementById(people[p]['face']).addEventListener('click', function () {
                    //tried to phish them
                    console.log("you tried to research " + people[p]['face']);
                    if (Math.random() > people[p]['caution']) {
                        //successfully researched them
                        console.log("researching successful!");
                        const whom = document.getElementById(people[p]['face']);
                        /*
                        <div id="myDiv">This is my div <span class="tooltip">This is my tooltip</span></div>
                        const myDiv = document.getElementById("myDiv");
                        myDiv.addEventListener("mouseover", showTooltip);
                        myDiv.addEventListener("mouseout", hideTooltip);                      
                        */
                        whom.innerHTML = people[p]['face'] + "<span class='tooltip'>Day " + days + ": 💰$" + people[p]['wallet'] + ", 💼$" + people[p]['salary'] + ", 📅: " + people[p]['times'] + "</span>";

                        whom.addEventListener("mouseover", showTooltip);
                        whom.addEventListener("mouseout", hideTooltip);
                    }
                })
            }
        })



        //timer and all that happens on it
        setInterval(function () {
            now += 1;
            if (now > 3) {
                now = 0;
                days += 1;
                for (p in people) {
                    people[p]['wallet'] += people[p]['salary']

                }
            }
            time = times[now];
            document.getElementById("clock")
                .innerHTML = "day " + days + " " + time + "\t$" + cash;

            for (p in people) {
                //console.log(people[p]);
                move(people[p], people[p]['times'][now]);

            }
        }, 6000);


    </script>

</body>